{% extends "base.html" %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'css/leaflet.css' %}"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.5.1/gpx.min.js"></script>

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.5.1/gpx.min.js"></script>-->

<script  src="{% static 'js/trip_detail.js' %}" defer></script>
<style>
  /* Vollbildkarte soll über dem Content liegen */
  #map:fullscreen {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    width: 100% !important;
    height: 100% !important;
    z-index: 9999;
  }
</style>
{% endblock %}


{% block content %}

<!-- Hero Map mit Vollbild-Button -->
<section class="hero is-fullwidth" style="margin-bottom: 2rem; position: relative;">
  <div id="map" style="width: 100%; height: 300px;"></div>
  <button
          id="fullscreenBtn"
          class="button is-link is-light"
          style="position: absolute; top: 1rem; right: 1rem; z-index: 1000;"
          aria-label="Vollbild umschalten"
          title="Vollbild umschalten"
  >
    <span class="icon"><i class="fas fa-expand"></i></span>
    <span>Vollbild</span>
  </button>
</section>

<!-- Content Container -->
<section class="section">
  <div class="container" style="max-width: 960px;">
    <div class="box" style="box-shadow: 0 2px 12px rgba(0,0,0,0.1); border-radius: 10px;">
      <!-- Titel und Datum -->
      <div class="content has-text-centered mb-5">
        <h1 class="title is-2">{{ trip.title }}</h1>
        <p class="subtitle is-5 has-text-grey">{{ trip.date }}</p>
      </div>

      <!-- Boot, Distanz, Dauer -->
      <nav class="level is-mobile mb-5">
        <div class="level-item has-text-centered">
          <div>
            <p class="heading">Boot</p>
            {% if trip.boat.info_url %}
            <p>
              <a href="{{ trip.boat.info_url }}" target="_blank" class="title is-4 has-text-link">
                {{ trip.boat.name }}
              </a>
            </p>
            {% else %}
            <p class="title is-4">{{ trip.boat.name }}</p>
            {% endif %}
          </div>
        </div>

        <div class="level-item has-text-centered">
          <div>
            <p class="heading">Distanz</p>
            <p class="title is-4">{{ trip.distance_nm|default:"–" }} sm</p>
          </div>
        </div>

        <div class="level-item has-text-centered">
          <div>
            <p class="heading">Dauer</p>
            <p class="title is-4">{{ trip.duration|default:"–" }}</p>
          </div>
        </div>
      </nav>

      <hr>

      <!-- Beschreibung -->
      <section class="content">
        <h2 class="title is-4">Beschreibung</h2>
        <p style="line-height: 1.6; font-size: 1.1rem;">{{ trip.description|linebreaks }}</p>
      </section>

      {% if trip.gpx_file %}
      <div class="has-text-right mt-5">
        <a href="{{ trip.gpx_file.url }}" class="button is-link is-light" download>
          <span class="icon"><i class="fas fa-download"></i></span>
          <span>GPX-Datei herunterladen</span>
        </a>
      </div>
      {% endif %}
    </div>
  </div>
</section>


{% endblock %}